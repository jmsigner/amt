<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prepare Data for UHC Plots for a Fitted Model — prep_uhc • amt</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare Data for UHC Plots for a Fitted Model — prep_uhc"><meta property="og:description" content="Creates data used to make used-habitat calibration plots"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">amt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/p1_getting_started.html">Getting started with `amt`</a>
    </li>
    <li>
      <a href="../articles/p2_hr.html">Calculating home-range overlaps with `amt`</a>
    </li>
    <li>
      <a href="../articles/p3_rsf.html">Resource Selection Functions (RSF) with `amt`</a>
    </li>
    <li>
      <a href="../articles/p4_SSF.html">Fitting Step-Selection Functions with `amt`</a>
    </li>
    <li>
      <a href="../articles/p5_other_packages.html">Interface to other packages with `amt`</a>
    </li>
    <li>
      <a href="../articles/p6_uhc_plots.html">UHC Plots</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jmsigner/amt/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepare Data for UHC Plots for a Fitted Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/jmsigner/amt/blob/master/R/uhc_plots.R" class="external-link"><code>R/uhc_plots.R</code></a></small>
    <div class="hidden name"><code>prep_uhc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates data used to make used-habitat calibration plots</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prep_uhc</span><span class="op">(</span><span class="va">object</span>, <span class="va">test_dat</span>, n_samp <span class="op">=</span> <span class="fl">1000</span>, n_dens <span class="op">=</span> <span class="fl">512</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'glm'</span></span>
<span><span class="fu">prep_uhc</span><span class="op">(</span><span class="va">object</span>, <span class="va">test_dat</span>, n_samp <span class="op">=</span> <span class="fl">1000</span>, n_dens <span class="op">=</span> <span class="fl">512</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'fit_logit'</span></span>
<span><span class="fu">prep_uhc</span><span class="op">(</span><span class="va">object</span>, <span class="va">test_dat</span>, n_samp <span class="op">=</span> <span class="fl">1000</span>, n_dens <span class="op">=</span> <span class="fl">512</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'fit_clogit'</span></span>
<span><span class="fu">prep_uhc</span><span class="op">(</span><span class="va">object</span>, <span class="va">test_dat</span>, n_samp <span class="op">=</span> <span class="fl">1000</span>, n_dens <span class="op">=</span> <span class="fl">512</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>[glm, fit_logit, fit_clogit]</code> <br> A fitted RSF or (i)SSF model.
Should be fit to <em>training</em> dataset separate from the testing data.</p></dd>


<dt id="arg-test-dat">test_dat<a class="anchor" aria-label="anchor" href="#arg-test-dat"></a></dt>
<dd><p><code>[data.frame]</code> <br> A <code>data.frame</code> with <em>testing</em> data from
which to sample test points. Should be separate from the data used to train
the model passed to <code>object</code>.</p></dd>


<dt id="arg-n-samp">n_samp<a class="anchor" aria-label="anchor" href="#arg-n-samp"></a></dt>
<dd><p><code>[numeric = 1000]</code> A <code>vector</code> of length 1 giving the number of
samples to use to characterize the used habitat distribution under the model.</p></dd>


<dt id="arg-n-dens">n_dens<a class="anchor" aria-label="anchor" href="#arg-n-dens"></a></dt>
<dd><p><code>[numeric = 512]</code> A <code>numeric</code> vector of length 1 giving the
number of equally spaced points at which density (used, available, and
sampled) is estimated. Passed to <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">stats::density.default()</a></code>, which indicates
that <code>n</code> should usually be specified as a power of 2.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>[logical]</code> Should messages be displayed (<code>TRUE</code>) or not
(<code>FALSE</code>)?</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a <code>list</code> of class <code>uhc_data</code> with elements:</p><ul><li><p><code>orig</code>: List of <code>data.frame</code>s, one per variable (see <code>vars</code>). Each
<code>data.frame</code> contains the density plot data (<code>x</code> and <code>y</code>) for the original
used (<code>dist == "U"</code>) and available (<code>dist == "A"</code>) data.</p></li>
<li><p><code>samp</code>: List of <code>data.frame</code>s, one per variable (see <code>vars</code>). Each
<code>data.frame</code> contains the density plot data (<code>x</code> and <code>y</code>) for each iteration
of bootstrap resampling (<code>iter</code>).</p></li>
<li><p><code>vars</code>: Character vector with names of the habitat variables for which to
create UHC plots.</p></li>
<li><p><code>type</code>: Named character vector with the type for each of <code>vars</code> (either
<code>"numeric"</code> or <code>"factor"</code>).</p></li>
<li><p><code>resp</code>: Character vector of length 1 with the name of the response
variable.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function performs the heavy lifting of creating UHC plots.
It creates the data used later by the <code><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot()</a></code> method, which actually
draws the UHC plots. This function (1) creates density plots of the used
and available locations from the <em>test</em> data, and (2) resamples the (a)
fitted coefficients and (b) test data (weighted by the exponential habitat
selection function) to create the distribution of used habitat under the
model.</p>
<p>Note that <code>test_dat</code> should contain at least all of the variables that
appear in the model <code>object</code>. Any further habitat variables in <code>test_dat</code>
will also have UHC plots generated, treating these variables as possible
candidate variables that are simply not included in this particular model.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Fieberg, J.R., Forester, J.D., Street, G.M., Johnson, D.H., ArchMiller, A.A.,
and Matthiopoulos, J. 2018. Used-habitat calibration plots: A new procedure
for validating species distribution, resource selection, and step-selection
models. <em>Ecography</em> 41:737–752.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See Fieberg <em>et al.</em> 2018 for details about UHC plots.</p>
<p>Default plotting method available: <code><a href="plot.uhc_data.html">plot.uhc_data</a>()</code></p>
<p>Coercion to <code>data.frame</code>: <code><a href="as.data.frame.uhc_data.html">as.data.frame.uhc_data</a>()</code></p>
<p>Subsetting method: <code><a href="Extract.uhc_data.html">Extract.uhc_data</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Brian J. Smith</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jmsigner/amt" class="external-link">amt</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> terra 1.7.83</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># HSF ----------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">uhc_hsf_locs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">uhc_hab</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">uhc_hab</span>, type <span class="op">=</span> <span class="st">"xyz"</span>, crs <span class="op">=</span> <span class="st">"epsg:32612"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Convert "cover" layer to factor</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/factors.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hab</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>                               cover <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grass"</span>, <span class="st">"forest"</span>, <span class="st">"wetland"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Split into train (80%) and test (20%)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">uhc_hsf_locs</span><span class="op">$</span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">uhc_hsf_locs</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">uhc_hsf_locs</span><span class="op">[</span><span class="va">uhc_hsf_locs</span><span class="op">$</span><span class="va">train</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">uhc_hsf_locs</span><span class="op">[</span><span class="va">uhc_hsf_locs</span><span class="op">$</span><span class="va">train</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Available locations</span></span></span>
<span class="r-in"><span><span class="va">avail_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="random_points.html">random_points</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">avail_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="random_points.html">random_points</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combine with used</span></span></span>
<span class="r-in"><span><span class="va">train_dat</span> <span class="op">&lt;-</span> <span class="va">train</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="track.html">make_track</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, crs <span class="op">=</span> <span class="fl">32612</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>case_ <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">avail_train</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="co"># Attach covariates</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="extract_covariates.html">extract_covariates</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="co"># Assign large weights to available</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">case_</span> <span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="op">!</span><span class="va">case_</span> <span class="op">~</span> <span class="fl">5000</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_dat</span> <span class="op">&lt;-</span> <span class="va">test</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="track.html">make_track</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, crs <span class="op">=</span> <span class="fl">32612</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>case_ <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">avail_test</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="co"># Attach covariates</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="extract_covariates.html">extract_covariates</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="co"># Assign large weights to available</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">case_</span> <span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    <span class="op">!</span><span class="va">case_</span> <span class="op">~</span> <span class="fl">5000</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit (correct) HSF</span></span></span>
<span class="r-in"><span><span class="va">hsf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">case_</span> <span class="op">~</span> <span class="va">forage</span> <span class="op">+</span> <span class="va">temp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">temp</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">pred</span> <span class="op">+</span> <span class="va">cover</span>,</span></span>
<span class="r-in"><span>            data <span class="op">=</span> <span class="va">train_dat</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>, weights <span class="op">=</span> <span class="va">weight</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Drop weights from 'test_dat'</span></span></span>
<span class="r-in"><span><span class="va">test_dat</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prep UHC plots</span></span></span>
<span class="r-in"><span><span class="va">uhc_dat</span> <span class="op">&lt;-</span> <span class="fu">prep_uhc</span><span class="op">(</span>object <span class="op">=</span> <span class="va">hsf1</span>, test_dat <span class="op">=</span> <span class="va">test_dat</span>,</span></span>
<span class="r-in"><span>                    n_samp <span class="op">=</span> <span class="fl">500</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> These variables in 'test_dat' will be treated as numeric: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    forage, temp, pred, dist_to_water, dist_to_cent, rand</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> These variables in 'test_dat' will be treated as categorical: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    cover</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 of 500     2 of 500     3 of 500     4 of 500     5 of 500     6 of 500     7 of 500     8 of 500     9 of 500     10 of 500     11 of 500     12 of 500     13 of 500     14 of 500     15 of 500     16 of 500     17 of 500     18 of 500     19 of 500     20 of 500     21 of 500     22 of 500     23 of 500     24 of 500     25 of 500     26 of 500     27 of 500     28 of 500     29 of 500     30 of 500     31 of 500     32 of 500     33 of 500     34 of 500     35 of 500     36 of 500     37 of 500     38 of 500     39 of 500     40 of 500     41 of 500     42 of 500     43 of 500     44 of 500     45 of 500     46 of 500     47 of 500     48 of 500     49 of 500     50 of 500     51 of 500     52 of 500     53 of 500     54 of 500     55 of 500     56 of 500     57 of 500     58 of 500     59 of 500     60 of 500     61 of 500     62 of 500     63 of 500     64 of 500     65 of 500     66 of 500     67 of 500     68 of 500     69 of 500     70 of 500     71 of 500     72 of 500     73 of 500     74 of 500     75 of 500     76 of 500     77 of 500     78 of 500     79 of 500     80 of 500     81 of 500     82 of 500     83 of 500     84 of 500     85 of 500     86 of 500     87 of 500     88 of 500     89 of 500     90 of 500     91 of 500     92 of 500     93 of 500     94 of 500     95 of 500     96 of 500     97 of 500     98 of 500     99 of 500     100 of 500     101 of 500     102 of 500     103 of 500     104 of 500     105 of 500     106 of 500     107 of 500     108 of 500     109 of 500     110 of 500     111 of 500     112 of 500     113 of 500     114 of 500     115 of 500     116 of 500     117 of 500     118 of 500     119 of 500     120 of 500     121 of 500     122 of 500     123 of 500     124 of 500     125 of 500     126 of 500     127 of 500     128 of 500     129 of 500     130 of 500     131 of 500     132 of 500     133 of 500     134 of 500     135 of 500     136 of 500     137 of 500     138 of 500     139 of 500     140 of 500     141 of 500     142 of 500     143 of 500     144 of 500     145 of 500     146 of 500     147 of 500     148 of 500     149 of 500     150 of 500     151 of 500     152 of 500     153 of 500     154 of 500     155 of 500     156 of 500     157 of 500     158 of 500     159 of 500     160 of 500     161 of 500     162 of 500     163 of 500     164 of 500     165 of 500     166 of 500     167 of 500     168 of 500     169 of 500     170 of 500     171 of 500     172 of 500     173 of 500     174 of 500     175 of 500     176 of 500     177 of 500     178 of 500     179 of 500     180 of 500     181 of 500     182 of 500     183 of 500     184 of 500     185 of 500     186 of 500     187 of 500     188 of 500     189 of 500     190 of 500     191 of 500     192 of 500     193 of 500     194 of 500     195 of 500     196 of 500     197 of 500     198 of 500     199 of 500     200 of 500     201 of 500     202 of 500     203 of 500     204 of 500     205 of 500     206 of 500     207 of 500     208 of 500     209 of 500     210 of 500     211 of 500     212 of 500     213 of 500     214 of 500     215 of 500     216 of 500     217 of 500     218 of 500     219 of 500     220 of 500     221 of 500     222 of 500     223 of 500     224 of 500     225 of 500     226 of 500     227 of 500     228 of 500     229 of 500     230 of 500     231 of 500     232 of 500     233 of 500     234 of 500     235 of 500     236 of 500     237 of 500     238 of 500     239 of 500     240 of 500     241 of 500     242 of 500     243 of 500     244 of 500     245 of 500     246 of 500     247 of 500     248 of 500     249 of 500     250 of 500     251 of 500     252 of 500     253 of 500     254 of 500     255 of 500     256 of 500     257 of 500     258 of 500     259 of 500     260 of 500     261 of 500     262 of 500     263 of 500     264 of 500     265 of 500     266 of 500     267 of 500     268 of 500     269 of 500     270 of 500     271 of 500     272 of 500     273 of 500     274 of 500     275 of 500     276 of 500     277 of 500     278 of 500     279 of 500     280 of 500     281 of 500     282 of 500     283 of 500     284 of 500     285 of 500     286 of 500     287 of 500     288 of 500     289 of 500     290 of 500     291 of 500     292 of 500     293 of 500     294 of 500     295 of 500     296 of 500     297 of 500     298 of 500     299 of 500     300 of 500     301 of 500     302 of 500     303 of 500     304 of 500     305 of 500     306 of 500     307 of 500     308 of 500     309 of 500     310 of 500     311 of 500     312 of 500     313 of 500     314 of 500     315 of 500     316 of 500     317 of 500     318 of 500     319 of 500     320 of 500     321 of 500     322 of 500     323 of 500     324 of 500     325 of 500     326 of 500     327 of 500     328 of 500     329 of 500     330 of 500     331 of 500     332 of 500     333 of 500     334 of 500     335 of 500     336 of 500     337 of 500     338 of 500     339 of 500     340 of 500     341 of 500     342 of 500     343 of 500     344 of 500     345 of 500     346 of 500     347 of 500     348 of 500     349 of 500     350 of 500     351 of 500     352 of 500     353 of 500     354 of 500     355 of 500     356 of 500     357 of 500     358 of 500     359 of 500     360 of 500     361 of 500     362 of 500     363 of 500     364 of 500     365 of 500     366 of 500     367 of 500     368 of 500     369 of 500     370 of 500     371 of 500     372 of 500     373 of 500     374 of 500     375 of 500     376 of 500     377 of 500     378 of 500     379 of 500     380 of 500     381 of 500     382 of 500     383 of 500     384 of 500     385 of 500     386 of 500     387 of 500     388 of 500     389 of 500     390 of 500     391 of 500     392 of 500     393 of 500     394 of 500     395 of 500     396 of 500     397 of 500     398 of 500     399 of 500     400 of 500     401 of 500     402 of 500     403 of 500     404 of 500     405 of 500     406 of 500     407 of 500     408 of 500     409 of 500     410 of 500     411 of 500     412 of 500     413 of 500     414 of 500     415 of 500     416 of 500     417 of 500     418 of 500     419 of 500     420 of 500     421 of 500     422 of 500     423 of 500     424 of 500     425 of 500     426 of 500     427 of 500     428 of 500     429 of 500     430 of 500     431 of 500     432 of 500     433 of 500     434 of 500     435 of 500     436 of 500     437 of 500     438 of 500     439 of 500     440 of 500     441 of 500     442 of 500     443 of 500     444 of 500     445 of 500     446 of 500     447 of 500     448 of 500     449 of 500     450 of 500     451 of 500     452 of 500     453 of 500     454 of 500     455 of 500     456 of 500     457 of 500     458 of 500     459 of 500     460 of 500     461 of 500     462 of 500     463 of 500     464 of 500     465 of 500     466 of 500     467 of 500     468 of 500     469 of 500     470 of 500     471 of 500     472 of 500     473 of 500     474 of 500     475 of 500     476 of 500     477 of 500     478 of 500     479 of 500     480 of 500     481 of 500     482 of 500     483 of 500     484 of 500     485 of 500     486 of 500     487 of 500     488 of 500     489 of 500     490 of 500     491 of 500     492 of 500     493 of 500     494 of 500     495 of 500     496 of 500     497 of 500     498 of 500     499 of 500     500 of 500     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot all variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">uhc_dat</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prep_uhc-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-4.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-5.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-6.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot only first variable</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">uhc_dat</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prep_uhc-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot only "cover" variable</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">uhc_dat</span><span class="op">[</span><span class="st">"cover"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prep_uhc-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Coerce to data.frame</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">uhc_dat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simplify sampled lines to confidence envelopes</span></span></span>
<span class="r-in"><span><span class="va">conf</span> <span class="op">&lt;-</span> <span class="fu"><a href="conf_envelope.html">conf_envelope</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Default plot for the envelopes version</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">conf</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="prep_uhc-10.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-11.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-12.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-13.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-14.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-15.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="prep_uhc-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Johannes Signer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

