<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UHC Plots • amt</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="UHC Plots">
<meta property="og:description" content="amt">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">amt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1_getting_started.html">Getting started with `amt`</a>
    </li>
    <li>
      <a href="../articles/p2_hr.html">Calculating home-range overlaps with `amt`</a>
    </li>
    <li>
      <a href="../articles/p3_rsf.html">Resource Selection Functions (RSF) with `amt`</a>
    </li>
    <li>
      <a href="../articles/p4_SSF.html">Fitting Step-Selection Functions with `amt`</a>
    </li>
    <li>
      <a href="../articles/p5_other_packages.html">Interface to other packages with `amt`</a>
    </li>
    <li>
      <a href="../articles/p6_uhc_plots.html">UHC Plots</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jmsigner/amt/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>UHC Plots</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jmsigner/amt/blob/HEAD/vignettes/p6_uhc_plots.Rmd" class="external-link"><code>vignettes/p6_uhc_plots.Rmd</code></a></small>
      <div class="hidden name"><code>p6_uhc_plots.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Used-habitat calibration plots (UHC plots) are a graphical method for
evaluating the calibration of a fitted HSF or (i)SSF model. The method
uses a combination of parametric (to account for parameter uncertainty)
and empirical bootstrapping to identify the distribution of used
habitat, conditional on the fitted model and a test dataset. It can be
used to identify problems in model specification, such as missing
predictors and misspecified functional forms (e.g., linear rather than
quadratic terms). For more details, see Fieberg et al. (2018).</p>
</div>
<div class="section level2">
<h2 id="implementation-in-amt">Implementation in <code>amt</code><a class="anchor" aria-label="anchor" href="#implementation-in-amt"></a>
</h2>
<p>We currently have an implementation of UHC plots in <code>amt</code>
for objects of class <code>fit_logit</code> and <code>glm</code> (HSFs)
and <code>fit_clogit</code> (iSSFs). The approach for both models is
similar, making use of generic functions with appropriate methods
depending on the class.</p>
<div class="section level3">
<h3 id="general-workflow">General workflow<a class="anchor" aria-label="anchor" href="#general-workflow"></a>
</h3>
<p>For either an HSF or (i)SSF, the workflow is as follows:</p>
<ol style="list-style-type: decimal">
<li>Prepare data for analysis</li>
<li>Split data into <strong>training</strong> and
<strong>testing</strong> datasets.</li>
<li>Use <strong>training</strong> dataset to fit candidate model(s) [HSF
or (i)SSF].</li>
<li>Prepare UHC plots by passing the fitted model and the
<strong>testing</strong> data to the function
<code><a href="../reference/prep_uhc.html">prep_uhc()</a></code>.</li>
<li>Create the UHC plots by calling <code><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot()</a></code> on the object
returned in (4).</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p><code>amt</code> contains simulated habitat data. This was once
stored as a <code>RasterStack</code>, but with conversion from
<code>raster</code> to <code>terra</code>, it is no longer possible to
store a <code>SpatRaster</code> as <code>*.rda</code> (the default
binary format for included data). Instead, <code>uhc_dat</code> is a
<code>data.frame</code> that can be converted to a
<code>SpatRaster</code> with <code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast()</a></code>. For
example:</p>
<pre><code><span><span class="va">hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">uhc_dat</span>, type <span class="op">=</span> <span class="st">"xyz"</span>, crs <span class="op">=</span> <span class="st">"epsg:32612"</span><span class="op">)</span></span></code></pre>
<p><code>amt</code> also contains location data simulated under (1) an
HSF and (2) an iSSF to demonstrate the UHC plot workflow.</p>
<p>The <code>SpatRaster</code> (<code>hab</code>, once converted)
contains 7 layers:</p>
<ul>
<li>
<code>forage</code>: forage biomass in g/m<sup>2</sup> (a
resource)</li>
<li>
<code>temp</code>: mean annual temperature in °C (a condition)</li>
<li>
<code>pred</code>: predator density in predators/100 km<sup>2</sup>
(a risk)</li>
<li>
<code>cover</code>: land cover categories (1 = grassland, 2 =
forest, 3 = wetland)</li>
<li>
<code>dist_to_water</code>: distance to the wetland category in m
(does not affect selection)</li>
<li>
<code>dist_to_cent</code>: distance to the center of the raster in m
(does not affect selection in HSF; avoidance of large distance to center
in iSSF)</li>
<li>
<code>rand</code>: random integer from -4 to 4 (does not affect
selection)</li>
</ul>
<p>Note that <code>temp</code>, a condition, is modeled with a quadratic
term in the simulations.</p>
<p>True parameter values under the simulation are in the description for
each dataset, <em>i.e.</em>, <code><a href="../reference/uhc_hsf_locs.html">?uhc_hsf_locs</a></code> and
<code><a href="../reference/uhc_issf_locs.html">?uhc_issf_locs</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load all the packages we need</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jmsigner/amt" class="external-link">amt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">uhc_hab</span><span class="op">)</span></span>
<span><span class="va">hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">uhc_hab</span>, type <span class="op">=</span> <span class="st">"xyz"</span>, crs <span class="op">=</span> <span class="st">"epsg:32612"</span><span class="op">)</span></span>
<span><span class="co"># Convert "cover" layer to factor</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/factors.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">hab</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>                                    cover <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grass"</span>, <span class="st">"forest"</span>, <span class="st">"wetland"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Affect habitat selection in simulation</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hab</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_uhc_plots_files/figure-html/habitat-1.png" width="672"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Do not affect habitat selection in simulation</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hab</span><span class="op">[[</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_uhc_plots_files/figure-html/habitat-2.png" width="672"></p>
<div class="section level3">
<h3 id="hsf-example">HSF Example<a class="anchor" aria-label="anchor" href="#hsf-example"></a>
</h3>
<p>The following is a demonstration of the workflow for an HSF.</p>
<div class="section level4">
<h4 id="prepare-data">Prepare data<a class="anchor" aria-label="anchor" href="#prepare-data"></a>
</h4>
<p>First, we combine steps (1) and (2) by splitting into train/test data
and then generating available locations and attributing with covariates
and model weights.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">uhc_hsf_locs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split into train (80%) and test (20%)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">uhc_hsf_locs</span><span class="op">$</span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">uhc_hsf_locs</span><span class="op">)</span>,</span>
<span>                             size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">uhc_hsf_locs</span><span class="op">[</span><span class="va">uhc_hsf_locs</span><span class="op">$</span><span class="va">train</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">uhc_hsf_locs</span><span class="op">[</span><span class="va">uhc_hsf_locs</span><span class="op">$</span><span class="va">train</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Available locations (entire raster extent)</span></span>
<span><span class="va">avail_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_points.html">random_points</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">avail_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_points.html">random_points</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                            n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine with used</span></span>
<span><span class="va">train_dat</span> <span class="op">&lt;-</span> <span class="va">train</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/track.html">make_track</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, crs <span class="op">=</span> <span class="fl">32612</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>case_ <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">avail_train</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Attach covariates</span></span>
<span>  <span class="fu"><a href="../reference/extract_covariates.html">extract_covariates</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Assign large weights to available</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">case_</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>    <span class="op">!</span><span class="va">case_</span> <span class="op">~</span> <span class="fl">5000</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_dat</span> <span class="op">&lt;-</span> <span class="va">test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/track.html">make_track</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, crs <span class="op">=</span> <span class="fl">32612</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>case_ <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">avail_test</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Attach covariates</span></span>
<span>  <span class="fu"><a href="../reference/extract_covariates.html">extract_covariates</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Note 'weight' column not created for test data</span></span>
<span><span class="co"># (we assume all variables in test are candidate habitat variables)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fit-models">Fit model(s)<a class="anchor" aria-label="anchor" href="#fit-models"></a>
</h4>
<p>Now we move onto step (3), where we fit candidate models. We’ll start
with a model that has an incorrect formulation. We will leave the
quadratic term out for <code>temp</code> and leave <code>cover</code>
out of the model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hsf_wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">case_</span> <span class="op">~</span> <span class="va">forage</span> <span class="op">+</span> <span class="va">temp</span> <span class="op">+</span> <span class="va">pred</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">train_dat</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>, weights <span class="op">=</span> <span class="va">weight</span><span class="op">)</span></span></code></pre></div>
<p>We will also fit the correct model, using the structure used to
generate the data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hsf_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">case_</span> <span class="op">~</span> <span class="va">forage</span> <span class="op">+</span> <span class="va">temp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">temp</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">pred</span> <span class="op">+</span> <span class="va">cover</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">train_dat</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>, weights <span class="op">=</span> <span class="va">weight</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="prepare-uhc-plot-data">Prepare UHC plot data<a class="anchor" aria-label="anchor" href="#prepare-uhc-plot-data"></a>
</h4>
<p>Next, onto step (4), where we use <code><a href="../reference/prep_uhc.html">prep_uhc()</a></code> to prepare
the UHC data. This is the function that does most of the heavy lifting
(<em>i.e.</em>, the boostrapping).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prep under wrong model</span></span>
<span><span class="va">uhc_hsf_wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_uhc.html">prep_uhc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">hsf_wrong</span>, test_dat <span class="op">=</span> <span class="va">test_dat</span>,</span>
<span>                          n_samp <span class="op">=</span> <span class="fl">100</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># In reality n_samp should be around 1000.</span></span>
<span></span>
<span><span class="co"># Prep under right model</span></span>
<span><span class="va">uhc_hsf_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_uhc.html">prep_uhc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">hsf_right</span>, test_dat <span class="op">=</span> <span class="va">test_dat</span>,</span>
<span>                          n_samp <span class="op">=</span> <span class="fl">100</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-uhc-plots">Plot UHC plots<a class="anchor" aria-label="anchor" href="#plot-uhc-plots"></a>
</h4>
<p>Finally, we are ready to plot (step 5). First, the wrong model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">uhc_hsf_wrong</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20wrong-1.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20wrong-2.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20wrong-3.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20wrong-4.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20wrong-5.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20wrong-6.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20wrong-7.png" width="672"></p>
<p>Note that the used proportions for <code>cover == "forest"</code> and
<code>cover == "wetland"</code> also fall above and below the modeled
envelope, respectively. These are our clues that the model is
incorrectly specified.</p>
<p>Note that <code>dist_to_water</code> also shows a mismatch between
observed and predicted values. If we didn’t already know that this was
an unimportant variable, we might consider including it in our model.
However, as we will see in the next set of plots, the correct model
specification does correctly capture <code>dist_to_water</code>
<em>without</em> needing to include it in the model.</p>
<p>Now, the right model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">uhc_hsf_right</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20right-1.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20right-2.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20right-3.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20right-4.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20right-5.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20right-6.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20right-7.png" width="672"></p>
<p>We can see these issues have been resolved for our <code>cover</code>
variables, indicating that our “right” model is, in fact, better
calibrated than <code>hsf_wrong</code>. Additionally, there is no longer
an issue with <code>dist_to_water</code>, confirming that we do not need
to include it in the model.</p>
<p>Note that with a large number of bootstrap samples, the plots are
quite complex and can take multiple seconds to render. If you are
working with many candidate variables, this makes examining all the plot
quite slow. We have included a few potential solutions to this
problem:</p>
<ul>
<li>First, you can plot just a single variable, by subsetting the
<code>uhc_data</code> object by either integers or the names of the
variables.</li>
<li>Second, you can convert the many lines to a single polygon
representing a confidence enevelope (with a confidence level of your
choice).</li>
</ul>
<p>Subsetting:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># By index</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">uhc_hsf_right</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20sub-1.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20sub-2.png" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># By names (vector of &gt;1 names also allowed)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">uhc_hsf_right</span><span class="op">[</span><span class="st">"cover"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20sub-3.png" width="672"></p>
<p>Envelope:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Coerce to data.frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">uhc_hsf_right</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create confidence envelopes (95% and 100%)</span></span>
<span><span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conf_envelope.html">conf_envelope</a></span><span class="op">(</span><span class="va">df</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20env-1.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20env-2.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20env-3.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20env-4.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20env-5.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20env-6.png" width="672"><img src="p6_uhc_plots_files/figure-html/hsf%20plot%20env-7.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="issf-example">iSSF Example<a class="anchor" aria-label="anchor" href="#issf-example"></a>
</h3>
<p>The following is a demonstration of the workflow for an iSSF.</p>
<div class="section level4">
<h4 id="prepare-data-1">Prepare data<a class="anchor" aria-label="anchor" href="#prepare-data-1"></a>
</h4>
<p>First, we combine steps (1) and (2) by splitting into train/test data
and then generating available locations and attributing with covariates
and model weights.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">uhc_issf_locs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Format as steps</span></span>
<span><span class="va">steps</span> <span class="op">&lt;-</span> <span class="va">uhc_issf_locs</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/track.html">make_track</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">t</span>, crs <span class="op">=</span> <span class="fl">32612</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/steps.html">steps</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split into train (80%) and test (20%)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">steps</span><span class="op">$</span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">steps</span><span class="op">)</span>,</span>
<span>                      size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">steps</span><span class="op">[</span><span class="va">steps</span><span class="op">$</span><span class="va">train</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">steps</span><span class="op">[</span><span class="va">steps</span><span class="op">$</span><span class="va">train</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Generate available steps, attribute</span></span>
<span><span class="va">train_dat</span> <span class="op">&lt;-</span> <span class="va">train</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/random_steps.html">random_steps</a></span><span class="op">(</span>n_control <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Attach covariates</span></span>
<span>  <span class="fu"><a href="../reference/extract_covariates.html">extract_covariates</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Additional movement parameters</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>log_sl_ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sl_</span><span class="op">)</span>,</span>
<span>         cos_ta_ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">ta_</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Drop 'train' column</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">train</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Get rid of any NAs (sometimes available steps fall outside of raster)</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/na.omit.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_dat</span> <span class="op">&lt;-</span> <span class="va">test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/random_steps.html">random_steps</a></span><span class="op">(</span>n_control <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Attach covariates</span></span>
<span>  <span class="fu"><a href="../reference/extract_covariates.html">extract_covariates</a></span><span class="op">(</span><span class="va">hab</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Additional movement parameters</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>log_sl_ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sl_</span><span class="op">)</span>,</span>
<span>         cos_ta_ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">ta_</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Drop 'train' column</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">train</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Get rid of any NAs (sometimes available steps fall outside of raster)</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/na.omit.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fit-models-1">Fit model(s)<a class="anchor" aria-label="anchor" href="#fit-models-1"></a>
</h4>
<p>Now we move onto step (3), where we fit candidate models. We’ll start
with a model that has an incorrect formulation.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">issf_wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_clogit.html">fit_issf</a></span><span class="op">(</span><span class="va">train_dat</span>, </span>
<span>                       <span class="va">case_</span> <span class="op">~</span> </span>
<span>                         <span class="co"># Habitat</span></span>
<span>                         <span class="va">forage</span> <span class="op">+</span> </span>
<span>                         <span class="co"># Movement</span></span>
<span>                         <span class="va">sl_</span> <span class="op">+</span> <span class="va">log_sl_</span> <span class="op">+</span> <span class="va">cos_ta_</span> <span class="op">+</span></span>
<span>                         <span class="co"># Strata</span></span>
<span>                         <span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">step_id_</span><span class="op">)</span>, model <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We will also fit the correct model, using the structure used to
generate the data.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">issf_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_clogit.html">fit_issf</a></span><span class="op">(</span><span class="va">train_dat</span>, </span>
<span>                       <span class="va">case_</span> <span class="op">~</span> </span>
<span>                         <span class="co"># Habitat</span></span>
<span>                         <span class="va">forage</span> <span class="op">+</span> <span class="va">temp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">temp</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">pred</span> <span class="op">+</span> <span class="va">cover</span> <span class="op">+</span> <span class="va">dist_to_cent</span> <span class="op">+</span></span>
<span>                         <span class="co"># Movement</span></span>
<span>                         <span class="va">sl_</span> <span class="op">+</span> <span class="va">log_sl_</span> <span class="op">+</span> <span class="va">cos_ta_</span> <span class="op">+</span></span>
<span>                         <span class="co"># Strata</span></span>
<span>                         <span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">step_id_</span><span class="op">)</span>, model <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="prepare-uhc-plot-data-1">Prepare UHC plot data<a class="anchor" aria-label="anchor" href="#prepare-uhc-plot-data-1"></a>
</h4>
<p>Next, onto step (4), where we use <code><a href="../reference/prep_uhc.html">prep_uhc()</a></code> to prepare
the UHC data. This is the function that does most of the heavy lifting
(<em>i.e.</em>, the bootstrapping).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prep under wrong model</span></span>
<span><span class="va">uhc_issf_wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_uhc.html">prep_uhc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">issf_wrong</span>, test_dat <span class="op">=</span> <span class="va">test_dat</span>,</span>
<span>                           n_samp <span class="op">=</span> <span class="fl">20</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prep under right model</span></span>
<span><span class="va">uhc_issf_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_uhc.html">prep_uhc</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">issf_right</span>, test_dat <span class="op">=</span> <span class="va">test_dat</span>,</span>
<span>                           n_samp <span class="op">=</span> <span class="fl">20</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-uhc-plots-1">Plot UHC plots<a class="anchor" aria-label="anchor" href="#plot-uhc-plots-1"></a>
</h4>
<p>Finally, we are ready to plot (step 5). First, the wrong model.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">uhc_issf_wrong</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_uhc_plots_files/figure-html/issf%20plot%20wrong-1.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20wrong-2.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20wrong-3.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20wrong-4.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20wrong-5.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20wrong-6.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20wrong-7.png" width="672"></p>
<p>We can see that every variable besides <code>rand</code> shows a
mismatch between observed and expected.</p>
<p>Now, the right model.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">uhc_issf_right</span><span class="op">)</span></span></code></pre></div>
<p><img src="p6_uhc_plots_files/figure-html/issf%20plot%20right-1.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20right-2.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20right-3.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20right-4.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20right-5.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20right-6.png" width="672"><img src="p6_uhc_plots_files/figure-html/issf%20plot%20right-7.png" width="672"></p>
<p>Every variable now shows matches between observed and expected.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="additional-methods">Additional Methods<a class="anchor" aria-label="anchor" href="#additional-methods"></a>
</h2>
<p>There is also a function to coerce a <code>uhc_data</code> object to
<code>data.frame</code>. This would be useful, for example, if you wish
to create a custom plot with <code>ggplot2</code> or another
package.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Structure of `uhc_data` object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">uhc_issf_right</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 6</span></span>
<span><span class="co">#&gt;  $ orig:List of 7</span></span>
<span><span class="co">#&gt;  $ samp:List of 7</span></span>
<span><span class="co">#&gt;  $ vars: chr [1:7] "forage" "temp" "pred" "cover" ...</span></span>
<span><span class="co">#&gt;  $ lims:List of 7</span></span>
<span><span class="co">#&gt;  $ type: Named chr [1:7] "numeric" "numeric" "numeric" "factor" ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:7] "forage" "temp" "pred" "cover" ...</span></span>
<span><span class="co">#&gt;  $ resp: chr "case_"</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr [1:2] "uhc_data" "list"</span></span>
<span></span>
<span><span class="co"># Coerce to data.frame</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">uhc_issf_right</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;       var        x            y dist iter label</span></span>
<span><span class="co">#&gt; 1  forage 239.4147 1.116098e-06    U   NA  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2  forage 240.9079 1.268620e-06    U   NA  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3  forage 242.4012 1.436511e-06    U   NA  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4  forage 243.8944 1.627104e-06    U   NA  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5  forage 245.3876 1.838193e-06    U   NA  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6  forage 246.8809 2.068999e-06    U   NA  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 7  forage 248.3741 2.320488e-06    U   NA  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 8  forage 249.8673 2.599519e-06    U   NA  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 9  forage 251.3606 2.907204e-06    U   NA  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10 forage 252.8538 3.239966e-06    U   NA  &lt;NA&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Fieberg, J.R., Forester, J.D., Street, G.M., Johnson, D.H.,
ArchMiller, A.A., and Matthiopoulos, J. 2018. Used-habitat calibration
plots: A new procedure for validating species distribution, resource
selection, and step-selection models. <em>Ecography</em> 41:737–752.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Johannes Signer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
